<HTML>
<BODY bgcolor="#ffffff" text="#000000">
<A NAME = "Proc2"></A>
<TABLE WIDTH=100% CELLPADDING=1 BORDER=2>
<TR>
<TD VALIGN=TOP BGCOLOR="darkblue" ><B><FONT SIZE=5 COLOR="white" FACE="Arial">SP_DesabilitaComponentes&nbsp;</FONT></B></TD>
</TR>
</TABLE>
<TABLE WIDTH=100% CELLPADDING=2 BORDER=2>
<TR>
<TD VALIGN=TOP WIDTH=20%% bgcolor="#87BCFF"><B><FONT SIZE=2 FACE="Arial">Description&nbsp;</FONT></B></TD>
<TD><FONT SIZE=2 FACE="Arial">Procedure que desabilita os principais registros de componentes do computador sempre que o banco recebe informações do mesmo&nbsp;</FONT></TD>
</TR>
<TR>
<TD VALIGN=TOP WIDTH=20%% bgcolor="#87BCFF"><B><FONT SIZE=2 FACE="Arial">SQL&nbsp;</FONT></B></TD>
<TD><TT><TT>CREATE PROCEDURE SP_DesabilitaComponentes</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp @SerialNumber_Win32_ComputerSystem VARCHAR(255)</TT><BR><TT>AS</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp DECLARE @DATA DATETIME;</TT><BR><TT>BEGIN</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp SET @DATA = GETDATE();</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_CDROMDrive SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_DiskDrive SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_DiskPartition SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_LogicalDisk SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_Keyboard SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_MonitorDetails SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_NetworkAdapter SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_NetworkAdapterConfiguration SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_OperatingSystem SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_PhysicalMemory SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_PointingDevice SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_Printer SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_Processor SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_Product SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_QuickFixEngineering SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_Service SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT></TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp UPDATE Win32_VideoController SET CADC_Ativo = 0, CADC_DataDesativacao = @DATA</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp WHERE SerialNumber_Win32_ComputerSystem = @SerialNumber_Win32_ComputerSystem</TT><BR><TT>&nbsp&nbsp&nbsp&nbsp&nbsp AND CADC_Ativo = 1;</TT><BR><TT>END</TT>&nbsp;</TT></TD>
</TR>
</TABLE>
</BODY>
</HTML>
